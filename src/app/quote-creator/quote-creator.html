<mat-card class="quote-card">
  <mat-card-header class="quote-header">
    <img src="../../multimedia/logo.png" alt="logouwu">
    <div class="quote-title">
      <h1>COTIZACIÓN</h1>
      <span>{{ numeroCotizacion }}</span>
    </div>
  </mat-card-header>

  <mat-card-content class="quote-body">
    <div class="client-info">
      <mat-form-field appearance="outline" class="client-field">
        <mat-label>Cliente</mat-label>
        <input matInput [(ngModel)]="cliente" placeholder="Nombre del cliente">
      </mat-form-field>
      <mat-form-field appearance="outline" class="date-field">
        <mat-label>Fecha</mat-label>
        <input matInput [(ngModel)]="fecha">
      </mat-form-field>
    </div>

    <h3>Detalle</h3>

    <div class="desktop-table">
      <table mat-table [dataSource]="items" class="mat-elevation-z2 items-table">
        <ng-container matColumnDef="numero">
          <th mat-header-cell *matHeaderCellDef> # </th>
          <td mat-cell *matCellDef="let i = index"> {{ i + 1 }} </td>
        </ng-container>
        <ng-container matColumnDef="descripcion">
          <th mat-header-cell *matHeaderCellDef> Descripción </th>
          <td mat-cell *matCellDef="let item">
            <mat-form-field appearance="fill">
              <input matInput [(ngModel)]="item.descripcion" placeholder="Servicio o producto">
            </mat-form-field>
          </td>
        </ng-container>
        <ng-container matColumnDef="cantidad">
          <th mat-header-cell *matHeaderCellDef> Cant. </th>
          <td mat-cell *matCellDef="let item">
            <mat-form-field appearance="fill">
              <input matInput type="number" [(ngModel)]="item.cantidad" min="1">
            </mat-form-field>
          </td>
        </ng-container>
        <ng-container matColumnDef="precioUnitario">
          <th mat-header-cell *matHeaderCellDef> P. Unitario </th>
          <td mat-cell *matCellDef="let item">
            <mat-form-field appearance="fill">
              <input matInput type="number" [(ngModel)]="item.precioUnitario" min="0">
            </mat-form-field>
          </td>
        </ng-container>
        <ng-container matColumnDef="total">
          <th mat-header-cell *matHeaderCellDef> Total </th>
          <td mat-cell *matCellDef="let item" class="total-cell"> {{ (item.cantidad * item.precioUnitario) | currency:'S/ ' }} </td>
        </ng-container>
        <ng-container matColumnDef="acciones">
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let item">
            <button mat-icon-button color="warn" (click)="removeItem(item.id)">
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </div>

    <div class="mobile-items-list">
      <mat-card *ngFor="let item of items; let i = index" class="item-card">
        <div class="item-card-header">
          <span class="item-number">Item #{{ i + 1 }}</span>
          <button mat-icon-button color="warn" (click)="removeItem(item.id)">
            <mat-icon>delete_forever</mat-icon>
          </button>
        </div>
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Descripción</mat-label>
          <input matInput [(ngModel)]="item.descripcion" placeholder="Servicio o producto">
        </mat-form-field>
        <div class="inputs-row">
          <mat-form-field appearance="outline">
            <mat-label>Cantidad</mat-label>
            <input matInput type="number" [(ngModel)]="item.cantidad" min="1">
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>P. Unitario</mat-label>
            <input matInput type="number" [(ngModel)]="item.precioUnitario" min="0">
          </mat-form-field>
        </div>
        <div class="item-total">
          <span>Total Item:</span>
          <strong>{{ (item.cantidad * item.precioUnitario) | currency:'S/ ' }}</strong>
        </div>
      </mat-card>
    </div>

    <button mat-stroked-button color="primary" class="add-item-btn" (click)="addItem()">
      <mat-icon>add</mat-icon> Añadir Item
    </button>

    <div class="summary">
      <div class="summary-item">
        <span>Subtotal</span>
        <strong>{{ subtotal | currency:'S/ ' }}</strong>
      </div>
      <div class="summary-item">
        <span>IGV (18%)</span>
        <strong>{{ igv | currency:'S/ ' }}</strong>
      </div>
      <div class="summary-item total">
        <span>TOTAL</span>
        <strong>{{ total | currency:'S/ ' }}</strong>
      </div>
    </div>
  </mat-card-content>

  <mat-card-actions align="end">
    <button mat-flat-button color="primary" class="export-btn" (click)="generarPDF()">
      <mat-icon>picture_as_pdf</mat-icon> Generar PDF
    </button>
  </mat-card-actions>
</mat-card>
